<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <!-- 引入样式 -->
  <link rel="stylesheet" href="https://unpkg.com/element-ui/lib/theme-chalk/index.css">
  <link rel="stylesheet" href="../lib/mui.min.css">
</head>
<body>
  <div id="app">
    <m-button @click="userVisible = true">筛选用户</m-button>
    <m-select-users
      ref="select-users"
      :visible.sync="userVisible"
      :user-loading="userLoading"
      :current-batch-type="currentBatchType"
      :batch-options="batchOptions"
      :org-tree-data="orgTreeData"
      :org-tree-default-expand="orgTreeDefaultExpand"
      :user-list="userList"
      @batch-change="getUserListByBatchId"
      @update-org-tree="getUpdateChildOrgTree"
      @update-search-user="getUpdateSearchUser"
      @org-change="getUserList"
      @confirm="handleConfirm"
    ></m-select-users>
  </div>
</body>
  <!-- 先引入 Vue -->
  <script src="https://unpkg.com/vue/dist/vue.js"></script>
  <!-- 引入组件库 -->
  <script src="https://unpkg.com/element-ui/lib/index.js"></script>
  <script src="../lib/mui.unpkg.min.js"></script>
  <script>
    console.log(MUI);
    new Vue({
      el: '#app',
      data() {
    return {
      userVisible: false,
      userLoading: false,
      currentBatchType: "",
      batchOptions: [],
      orgTreeData: [
        {
          parent_id: "",
          childNum: 3,
          treeText: "架构顶级组织",
          value: "11b11db4-e907-4f1f-8835-b9daab6e1f23",
          city: "集团总部",
          org_code: "00.",
          code: "0000-",
          disable: false,
          childNode: [
            {
              parent_id: "11b11db4-e907-4f1f-8835-b9daab6e1f23",
              treeText: "襄阳公司",
              value: "39d15fe3-d45e-683a-8837-690651562b75",
              city: "",
              org_code: "00.A0168.",
              code: "0000-0168-",
              childNode: [],
              disable: false,
              childNum: 0
            },
            {
              parent_id: "11b11db4-e907-4f1f-8835-b9daab6e1f23",
              treeText: "UI自动化测试公司",
              value: "39f7ac49-19a0-dcaa-2740-6cc11c973756",
              city: "深圳",
              org_code: "00.A0002.",
              code: "0000-0002-",
              childNode: [],
              disable: false,
              childNum: 1
            }
          ]
        }
      ],
      orgTreeDefaultExpand: [],
      userList: [
        {
          id: "1",
          name: "可累计进口量",
          account:
            "撒娇的拉升阶段了刷卡机的卡拉就立刻阿斯利康大家ask来得及奥克兰"
        },
        {
          id: "2",
          name: "阿萨",
          account:
            "撒娇的拉升阶段了刷卡机的卡拉就立刻阿斯利康大家ask来得及奥克兰"
        }
      ]
    };
  },
  mounted() {
    this.orgTreeDefaultExpand = this.orgTreeData.map(v => v.value);
    this.batchOptions = [
      {
        batch_type: "专项检查",
        batch_list: [
          {
            id: "39f708b3-6991-4c35-581c-97a3e15b977c",
            name: "123243",
            batch_purpose: "正式"
          },
          {
            id: "39f590b9-94a5-0586-b164-63403cec3ddf",
            name: "20200604",
            batch_purpose: "正式"
          }
        ]
      },
      {
        batch_type: "模拟验房",
        batch_list: [
          {
            id: "39f9a10e-988b-18b4-bab8-a30cd9f7129b",
            name: "退回问题启用超级表单",
            batch_purpose: "正式"
          },
          {
            id: "39f99cde-19c0-4fad-263a-2a6e1f3df457",
            name: "房间楼栋单元筛选测试",
            batch_purpose: "正式"
          }
        ]
      }
    ];
    this.getDefaultBatch(this.batchOptions);
  },
  methods: {
    getDefaultBatch(options) {
      if (!options.length) {
        return;
      }
      var currentType = "模拟验房";
      this.currentBatchType = options[0].batch_type;
      const activeBatch = options.find(item => item.batch_type === currentType);
      if (activeBatch) {
        this.currentBatchType = activeBatch.batch_type;
      }
    },
    handleBatchChange(parmas) {
      console.log(parmas);
    },
    handleUpdateTree(node, resolve) {
      console.log("luchx ======> ", node, resolve);
    },
    getUpdateChildOrgTree() {},
    getUpdateSearchUser() {
      this.$refs["select-users"].changeRemoteSearchUser(
        [
          {
            account: "suxq01",
            id: "39f51ad8-634d-2d4d-6b50-920db7ad5995",
            name: "苏晓强-test"
          }
        ],
        true
      );
    },
    getUserList() {},
    getUserListByBatchId() {
      this.$refs["select-users"].changeRemoteSearchUser([
        {
          account: "suxq01",
          id: "39f51ad8-634d-2d4d-6b50-920db7ad5995",
          name: "苏晓强-test"
        }
      ]);
    },
    handleConfirm(data, next) {
      console.log(data);
      next();
    }
  }
    })
  </script>
</html>